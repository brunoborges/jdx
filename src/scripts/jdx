#!/usr/bin/env bash

# jdx launcher script for Unix-like systems (Linux, macOS)

# Resolve the script directory
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
APP_HOME="$( cd "$SCRIPT_DIR/.." && pwd )"

# Set up paths
LIB_DIR="$APP_HOME/lib"
JAR_FILE="$LIB_DIR/jdx-0.1.0-SNAPSHOT.jar"

# Check if custom runtime exists (from jlink)
if [ -d "$APP_HOME/runtime" ]; then
    JAVA_CMD="$APP_HOME/runtime/bin/java"
else
    # Fall back to system Java
    if [ -n "$JAVA_HOME" ]; then
        JAVA_CMD="$JAVA_HOME/bin/java"
    else
        JAVA_CMD="java"
    fi
fi

# Check if Java is available
if ! command -v "$JAVA_CMD" &> /dev/null; then
    echo "Error: Java is not installed or not in PATH"
    echo "Please install JDK 25 or later"
    exit 1
fi

# Launch the application
exec "$JAVA_CMD" -jar "$JAR_FILE" "$@"
